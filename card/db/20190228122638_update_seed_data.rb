# -*- encoding : utf-8 -*-

class UpdateSeedData < Card::Migration::Core
  def svg attr=""
    <<-SVG.strip_heredoc
      <svg style="#{attr}" viewBox="0 0 242 220" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
        <!-- Generator: Sketch 46.2 (44496) - http://www.bohemiancoding.com/sketch -->
        <title>b&amp;w_logo</title>
        <desc>Created with Sketch.</desc>
        <defs>
            <rect id="path-1" x="35.3297422" y="10.484836" width="157.279595" height="190.607432" rx="12.491335"></rect>
            <filter x="-12.1%" y="-10.5%" width="125.4%" height="121.0%" filterUnits="objectBoundingBox" id="filter-2">
                <feMorphology radius="1" operator="dilate" in="SourceAlpha" result="shadowSpreadOuter1"></feMorphology>
                <feOffset dx="1" dy="0" in="shadowSpreadOuter1" result="shadowOffsetOuter1"></feOffset>
                <feGaussianBlur stdDeviation="5.5" in="shadowOffsetOuter1" result="shadowBlurOuter1"></feGaussianBlur>
                <feColorMatrix values="0 0 0 0 0   0 0 0 0 0   0 0 0 0 0  0 0 0 0.1 0" type="matrix" in="shadowBlurOuter1"></feColorMatrix>
            </filter>
            <rect id="path-3" x="51.9878879" y="19.404077" width="123.9533" height="171.161486" rx="9.6888466"></rect>
            <filter x="-15.3%" y="-11.7%" width="132.3%" height="123.4%" filterUnits="objectBoundingBox" id="filter-4">
                <feMorphology radius="1" operator="dilate" in="SourceAlpha" result="shadowSpreadOuter1"></feMorphology>
                <feOffset dx="1" dy="0" in="shadowSpreadOuter1" result="shadowOffsetOuter1"></feOffset>
                <feGaussianBlur stdDeviation="5.5" in="shadowOffsetOuter1" result="shadowBlurOuter1"></feGaussianBlur>
                <feColorMatrix values="0 0 0 0 0   0 0 0 0 0   0 0 0 0 0  0 0 0 0.1 0" type="matrix" in="shadowBlurOuter1"></feColorMatrix>
            </filter>
            <path d="M70.1050368,35.6666109 L159.089911,35.6666109 L159.089911,35.6666109 C163.678051,35.6666109 167.397473,39.386033 167.397473,43.9741728 L167.397473,87.717145 L167.397473,166.808436 L167.397473,166.808436 C167.397473,171.396576 163.678051,175.115998 159.089911,175.115998 L70.1050368,175.115998 L70.1050368,175.115998 C65.516897,175.115998 61.7974749,171.396576 61.7974749,166.808436 L61.7974749,43.9741728 L61.7974749,43.9741728 C61.7974749,39.386033 65.516897,35.6666109 70.1050368,35.6666109 Z" id="path-5"></path>
            <filter x="-18.0%" y="-14.3%" width="137.9%" height="128.7%" filterUnits="objectBoundingBox" id="filter-6">
                <feMorphology radius="1" operator="dilate" in="SourceAlpha" result="shadowSpreadOuter1"></feMorphology>
                <feOffset dx="1" dy="0" in="shadowSpreadOuter1" result="shadowOffsetOuter1"></feOffset>
                <feGaussianBlur stdDeviation="5.5" in="shadowOffsetOuter1" result="shadowBlurOuter1"></feGaussianBlur>
                <feColorMatrix values="0 0 0 0 0   0 0 0 0 0   0 0 0 0 0  0 0 0 0.1 0" type="matrix" in="shadowBlurOuter1"></feColorMatrix>
            </filter>
            <rect id="path-7" x="70.7637805" y="49.8525134" width="92.149175" height="107.18743" rx="7.8659801"></rect>
            <filter x="-20.6%" y="-18.7%" width="143.4%" height="137.3%" filterUnits="objectBoundingBox" id="filter-8">
                <feMorphology radius="1" operator="dilate" in="SourceAlpha" result="shadowSpreadOuter1"></feMorphology>
                <feOffset dx="1" dy="0" in="shadowSpreadOuter1" result="shadowOffsetOuter1"></feOffset>
                <feGaussianBlur stdDeviation="5.5" in="shadowOffsetOuter1" result="shadowBlurOuter1"></feGaussianBlur>
                <feColorMatrix values="0 0 0 0 0   0 0 0 0 0   0 0 0 0 0  0 0 0 0.102553216 0" type="matrix" in="shadowBlurOuter1"></feColorMatrix>
            </filter>
        </defs>
        <g id="Page-3" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
            <g id="b&amp;w_logo" fill-rule="nonzero">
                <g id="Decko-Logo-" transform="translate(7.000000, 4.000000)">
                    <g id="g5642">
                        <g id="svg-card-1" transform="translate(113.969540, 105.788552) scale(-1, 1) rotate(105.855860) translate(-113.969540, -105.788552) ">
                            <use fill="black" fill-opacity="1" filter="url(#filter-2)" xlink:href="#path-1"></use>
                            <use fill="#4D4D4D" fill-rule="evenodd" xlink:href="#path-1"></use>
                        </g>
                        <g id="svg-card-2" opacity="0.879999995" transform="translate(113.964538, 104.984820) scale(-1, 1) rotate(117.480003) translate(-113.964538, -104.984820) ">
                            <use fill="black" fill-opacity="1" filter="url(#filter-4)" xlink:href="#path-3"></use>
                            <use fill="#FFFFFF" fill-rule="evenodd" xlink:href="#path-3"></use>
                        </g>
                        <g id="svg-card-3" transform="translate(114.597474, 105.391304) scale(-1, 1) rotate(133.539993) translate(-114.597474, -105.391304) ">
                            <use fill="black" fill-opacity="1" filter="url(#filter-6)" xlink:href="#path-5"></use>
                            <use fill="#4C4C4C" fill-rule="evenodd" xlink:href="#path-5"></use>
                        </g>
                        <g id="svg-card-4" opacity="0.879999995" transform="translate(116.838368, 103.446228) scale(-1, 1) rotate(142.690002) translate(-116.838368, -103.446228) ">
                            <use fill="black" fill-opacity="1" filter="url(#filter-8)" xlink:href="#path-7"></use>
                            <use fill="#FFFFFF" fill-rule="evenodd" xlink:href="#path-7"></use>
                        </g>
                    </g>
                </g>
            </g>
        </g>
      </svg>
    SVG
  end

  LAYOUT = <<-HTML.strip_heredoc
    <body class="right-sidebar">
      <header>{{*header|core}}</header>
      <article>{{_main|open}}</article>
      <aside>{{*sidebar|core}}</aside>
      <footer>{{*footer|core}}</footer>
    </body>
  HTML

  CREDIT = <<-HTML.strip_heredoc
    <div class="d-flex justify-content-around">{{+image|core}}</div>
    <div><a href="http://wagn.org">Decko v{{*version|core}}</a></div>
  HTML

  HEADER = <<-HTML.strip_heredoc
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark mb-3">
      <a class="navbar-brand nav-logo p-0" href="{{*home|home_path}}">
        {{*logo|core;size:small}}
      </a>
      <a class="navbar-brand" href="{{*home|home_path}}">
        {{*title|core}}
      </a>
      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
    
      <div class="collapse navbar-collapse" id="navbarSupportedContent">
        <ul class="navbar-nav mr-auto">
          {{*main menu|navbar_links}}
        </ul>
        {{*navbox|navbar}}
        {{*account links|navbar_links}}
      </div>
    </nav>
  HTML



  def up
    update "*logo", type_id: Card::ImageID, storage_type: :coded,
                    mod: :standard, image: File.open(File.join(data_path, "decko_logo.svg"))
                    # content: svg("min-width: 75px; min-height: 55px;")
    update "*credit+image", type_id: Card::HtmlID,
                            content: svg("width:110px; height:100px;")
    update "*credit", type_id: Card::HtmlID, content: CREDIT
    update "*header", content: HEADER
    update "Default Layout", content: LAYOUT

    names = %w[
      home home+original
      *footer *credit *sidebar
      *title
      *all+*layout
      home+*self+*layout
      default_layout home_layout
      full_width_layout
      ]
    names.select { |n| !Card.exists?(n) || Card.fetch(n)&.pristine? }
    merge_cards names
    ensure_card "*all+*guide", content: GUIDE, type_id: Card::MarkdownID
  end
end
