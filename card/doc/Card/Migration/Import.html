<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Class: Card::Migration::Import
  
    &mdash; Documentation by YARD 0.9.5
  
</title>

  <link rel="stylesheet" href="../../css/style.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="../../css/common.css" type="text/css" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  pathId = "Card::Migration::Import";
  relpath = '../../';
</script>


  <script type="text/javascript" charset="utf-8" src="../../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../../js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="../../class_list.html"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="../../_index.html">Index (I)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../../Card.html" title="Card (class)">Card</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../Migration.html" title="Card::Migration (class)">Migration</a></span></span>
     &raquo; 
    <span class="title">Import</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../../class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <iframe id="search_frame" src="../../class_list.html"></iframe>

      <div id="content"><h1>Class: Card::Migration::Import
  
  
  
</h1>
<div class="box_info">
  
  <dl>
    <dt>Inherits:</dt>
    <dd>
      <span class="inheritName">Object</span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next">Card::Migration::Import</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
    </dd>
  </dl>
  

  
  
  
  
  

  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>lib/card/migration/import.rb<span class="defines">,<br />
  lib/card/migration/import/import_data.rb</span>
</dd>
  </dl>
  
</div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<p>Imports card data from a local or remote deck</p>

<p>The cards&#39; content for the import is stored for every card in a
separate file, other attributes like name or type are stored for all cards
together in a yml file.</p>

<p>To update a card&#39;s content you only have to change the card&#39;s
content file. The merge method will recognize that the file was changed
since the last merge and merge it into the cards table To update other
attributes change them in the yml file and either remove the
&#39;merged&#39; value or touch the corresponding content file</p>


  </div>
</div>
<div class="tags">
  

</div><h2>Defined Under Namespace</h2>
<p class="children">
  
    
  
    
      <strong class="classes">Classes:</strong> <span class='object_link'><a href="Import/ImportData.html" title="Card::Migration::Import::ImportData (class)">ImportData</a></span>
    
  
</p>

  <h2>Constant Summary</h2>
  <dl class="constants">
    
      <dt id="OUTPUT_FILE-constant" class="">OUTPUT_FILE =
        
      </dt>
      <dd><pre class="code"><span class='const'>Card</span><span class='op'>::</span><span class='const'>Migration</span><span class='period'>.</span><span class='id identifier rubyid_data_path'>data_path</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>unmerged</span><span class='tstring_end'>&quot;</span></span></pre></dd>
    
  </dl>







  
    <h2>
      Class Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#add_card-class_method" title="add_card (class method)">.<strong>add_card</strong>(attr)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Add a card with the given attributes to the import data.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#add_remote-class_method" title="add_remote (class method)">.<strong>add_remote</strong>(name, url)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Save an url as remote deck to make it available for the pull method.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#merge-class_method" title="merge (class method)">.<strong>merge</strong>(all = false)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Merge the import data into the cards table If &#39;all&#39; is true all
import data is merged.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#pull-class_method" title="pull (class method)">.<strong>pull</strong>(name, opts = {})  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Get import data from a deck.</p>
</div></span>
  
</li>

      
    </ul>
  



  <div id="class_method_details" class="method_details_list">
    <h2>Class Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="add_card-class_method">
  
    .<strong>add_card</strong>(attr)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Add a card with the given attributes to the import data</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


56
57
58
59
60</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/card/migration/import.rb', line 56</span>

<span class='kw'>def</span> <span class='id identifier rubyid_add_card'>add_card</span> <span class='id identifier rubyid_attr'>attr</span>
  <span class='const'>ImportData</span><span class='period'>.</span><span class='id identifier rubyid_update'>update</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_data'>data</span><span class='op'>|</span>
    <span class='id identifier rubyid_data'>data</span><span class='period'>.</span><span class='id identifier rubyid_add_card'>add_card</span> <span class='id identifier rubyid_attr'>attr</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="add_remote-class_method">
  
    .<strong>add_remote</strong>(name, url)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Save an url as remote deck to make it available for the pull method</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


63
64
65
66
67</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/card/migration/import.rb', line 63</span>

<span class='kw'>def</span> <span class='id identifier rubyid_add_remote'>add_remote</span> <span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_url'>url</span>
  <span class='const'>ImportData</span><span class='period'>.</span><span class='id identifier rubyid_update'>update</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_data'>data</span><span class='op'>|</span>
    <span class='id identifier rubyid_data'>data</span><span class='period'>.</span><span class='id identifier rubyid_add_remote'>add_remote</span> <span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_url'>url</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="merge-class_method">
  
    .<strong>merge</strong>(all = false)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Merge the import data into the cards table If &#39;all&#39; is true all
import data is merged. Otherwise only the data that was changed or added
since the last merge</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


22
23
24
25
26
27
28
29
30
31
32
33
34
35
36</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/card/migration/import.rb', line 22</span>

<span class='kw'>def</span> <span class='id identifier rubyid_merge'>merge</span> <span class='id identifier rubyid_all'>all</span><span class='op'>=</span><span class='kw'>false</span>
  <span class='id identifier rubyid_merge_data'>merge_data</span> <span class='op'>=</span> <span class='id identifier rubyid_all'>all</span> <span class='op'>?</span> <span class='const'>ImportData</span><span class='period'>.</span><span class='id identifier rubyid_all_cards'>all_cards</span> <span class='op'>:</span> <span class='const'>ImportData</span><span class='period'>.</span><span class='id identifier rubyid_changed_cards'>changed_cards</span>
  <span class='id identifier rubyid_puts'>puts</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>nothing to merge</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='op'>&amp;&amp;</span> <span class='kw'>return</span> <span class='kw'>if</span> <span class='id identifier rubyid_merge_data'>merge_data</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>

  <span class='const'>Card</span><span class='op'>::</span><span class='const'>Mailer</span><span class='period'>.</span><span class='id identifier rubyid_perform_deliveries'>perform_deliveries</span> <span class='op'>=</span> <span class='kw'>false</span>
  <span class='const'>Card</span><span class='op'>::</span><span class='const'>Auth</span><span class='period'>.</span><span class='id identifier rubyid_as_bot'>as_bot</span> <span class='kw'>do</span>
    <span class='const'>Card</span><span class='period'>.</span><span class='id identifier rubyid_merge_list'>merge_list</span> <span class='id identifier rubyid_merge_data'>merge_data</span><span class='comma'>,</span> <span class='label'>output_file:</span> <span class='const'>OUTPUT_FILE</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_update_time'>update_time</span> <span class='op'>=</span> <span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_zone'>zone</span><span class='period'>.</span><span class='id identifier rubyid_now'>now</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span>
  <span class='const'>ImportData</span><span class='period'>.</span><span class='id identifier rubyid_update'>update</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_import_data'>import_data</span><span class='op'>|</span>
    <span class='id identifier rubyid_merge_data'>merge_data</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_card_data'>card_data</span><span class='op'>|</span>
      <span class='id identifier rubyid_import_data'>import_data</span><span class='period'>.</span><span class='id identifier rubyid_merged'>merged</span> <span class='id identifier rubyid_card_data'>card_data</span><span class='comma'>,</span> <span class='id identifier rubyid_update_time'>update_time</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="pull-class_method">
  
    .<strong>pull</strong>(name, opts = {})  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Get import data from a deck</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>name</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The name of the card to be imported</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>opts</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>{}</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>pull options</p>
</div>
      
    </li>
  
</ul>

  
    
    
    
    
    <p class="tag_title">Options Hash (<tt>opts</tt>):</p>
    <ul class="option">
      
        <li>
          <span class="name">remote</span>
          <span class="type">(<tt>String</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>Use a remote url. The remote url must have been registered via
&#39;add_remote&#39;</p>
</div>
          
        </li>
      
        <li>
          <span class="name">deep</span>
          <span class="type">(<tt>Boolean</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>if true fetch all nested cards, too</p>
</div>
          
        </li>
      
        <li>
          <span class="name">items_only</span>
          <span class="type">(<tt>Boolean</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>if true fetch all nested cards but not the card itself</p>
</div>
          
        </li>
      
    </ul>
  


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


46
47
48
49
50
51
52
53</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/card/migration/import.rb', line 46</span>

<span class='kw'>def</span> <span class='id identifier rubyid_pull'>pull</span> <span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_opts'>opts</span><span class='op'>=</span><span class='lbrace'>{</span><span class='rbrace'>}</span>
  <span class='const'>ImportData</span><span class='period'>.</span><span class='id identifier rubyid_update'>update</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_import_data'>import_data</span><span class='op'>|</span>
    <span class='id identifier rubyid_url'>url</span> <span class='op'>=</span> <span class='id identifier rubyid_opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:remote</span><span class='rbracket'>]</span> <span class='op'>?</span> <span class='id identifier rubyid_import_data'>import_data</span><span class='period'>.</span><span class='id identifier rubyid_url'>url</span><span class='lparen'>(</span><span class='id identifier rubyid_opts'>opts</span><span class='period'>.</span><span class='id identifier rubyid_delete'>delete</span><span class='lparen'>(</span><span class='symbol'>:remote</span><span class='rparen'>)</span><span class='rparen'>)</span> <span class='op'>:</span> <span class='kw'>nil</span>
    <span class='id identifier rubyid_fetch_card_data'>fetch_card_data</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_url'>url</span><span class='comma'>,</span> <span class='id identifier rubyid_opts'>opts</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_card_data'>card_data</span><span class='op'>|</span>
      <span class='id identifier rubyid_import_data'>import_data</span><span class='period'>.</span><span class='id identifier rubyid_add_card'>add_card</span> <span class='id identifier rubyid_card_data'>card_data</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Mon Aug 15 14:23:52 2016 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.5 (ruby-2.3.0).
</div>

    </div>
  </body>
</html>